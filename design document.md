设计文档

语言

c++

python

java

需求

1. 支持大文件传输，例如1G的电影
2. 包括客户端和服务端，遵从命令格式
3. 使用UDP作为传输层协议
4. 100%可靠性 （大量测试）
5. 流控制
6. 堵塞控制
7. 服务端并发访问控制
8. 提供有效查错信息

实现思路

- 服务端
  1. 在某IP某端口alway-on
- 客户端
  2. 对服务端发起上传、下载请求

功能：上传和下载，无损坏无间隔费冗余按序

先仅考虑上传功能：视频从客户端到服务端

基础设施：

- 基础设施：sender处理的主要事件

  - 接受到传输命令

    从文件系统读取文件数据，大文件->字节流->加上TCP有关头部（序号和确认号）并封装分组，估计往返时间，维护计时器；

  - 超时

    重传并重启定时器；

  - 接收到有效ACK字段值的报文段

    比较ACK携带的值y和SendBase

    ​	若y>SendBase，更新SendBase=y（则该ACK是在确认一个或多个先前未确认的报文段）；若当前仍有未被确认的报文段，重启定时器；

    ​	否则，递增ACK counter for y；若counter为3，重传报文段y   //快速重传

  - 超时间隔加倍

  - 回退N步还是选择重传

- 基础设施：receiver处理的主要事件

  - 维护一个接收buffer
  - 将数据段拆出放入buffer，若没有问题，将相关字节流接入文件系统；(buffer满/按序) 时将数据append到文件后

- 流控制

  - 下载时，server即sender；
  - 发送方跟踪两个变量并保证
  - 当接收到rwnd = 0，继续发送只有一个字节的分组，直到收到>0

- 堵塞控制

  原理：发送方感知网络行为0.0

  - 